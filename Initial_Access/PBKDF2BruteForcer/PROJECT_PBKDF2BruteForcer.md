# **Project PBKDF2BruteForcer**
## PBKDF2? What is that!?

### **Scenario:** 
##### During a Red Team engagement you found a password for the Directory Manager account for an LDAP server that you were able to dump stored hashes from. Upon further inspection, you realized that the hashes you pulled were actually base64 encoded strings that revealed PBKDF2 hashes that were generated from a 389-ds. You need to figure out how you could crack those sweet hashes so you can further expand your access into the network.

```
# Example to Test against (Simulated LDAP dump) ::: 'Password should be P@ssw0rd1!'
$bash2.4> ldapsearch -D "cn=Directory Manager" -x -W -b 'cn=admin,cn=users,cn=accounts,dc=example,dc=local' uid userpassword krbprincipalkey
...
# admin, users, accounts, example.local
dn: uid=admin,cn=users,cn=accounts,dc=example,dc=local
uid: admin
userpassword:: e1BCS0RGMl9TSEEyNTZ9QUFBSUFOMHArZUc5cTVKMWkvVVdSNSs5Q3l4R2JkbW0
 1VERab2tQZSs1dXpMSE93V2tZR3Btb1JKRnZ0VHV3NlM3N1NkcmFvUG5qY3JjZHNkbGpzM01Na1pY
 N0pnOFVJVWJsRGNwUWhRcG9TVGVCYi9SUHROUEtWWUEwNERxNlBGWmxHbDJtQ3E1aGJUNGlJRDgrV
 2xJMHNMdWhtNEsya1FTWnE1aEIrY1ptT3RoSDZpRHNyb1hCMTZ1SG1OYUpoT1BFc2EzSkZtQTZ6el
 d6Sk1sc21LQzFGbnRSY3RSbTdQemRpYSt0bHRBejVMNFJHNnFkaFJtb0lQbXdiMWhTS1FXODFiQzl
 zUjdDMUVubEJHWk5kTktCWVlNVEplSldOMUtJd2tLUnFkR3RjektwS3ByU0oyMmVDekNrYXdRdnlQ
 bFd0TVFDWkRIdVpEN1UySDFQM2swenRhVTJqNzNCUHFndjZQQUUrWDFoRUlzREJMdHZkemZHd0ZUV
 EsvVWpMd0hBTXlEd3NEUVA0SnkzZVRHZWZraUVWN1MraVpmVnRUUTRaL2gvY2xha2E5WElz
krbprincipalkey:: MIHeoAMCAQGhAwIBAaIDAgECowMCAQGkgccwgcQwaKAbMBmgAwIBBKESBBA9
 VUJ3MFUmPGAmVytJYUBooUkwR6ADAgESoUAEPiAAzNKn24GEzoDlN2yOn9p3hmFAgckZZPmLGuGza
 gs0rdu13Kao3zWJOim/bdi9xAeK4u3UWBfB9OXiKMwDMFigGzAZoAMCAQShEgQQLDZMKndCIyVHfS
 hbITpZP6E5MDegAwIBEaEwBC4QAG9prwxsa0Rvva1tmRXNtFFvpP1xB1nvbATbbgVucLmBOw4OpMk
 XV68IcwMk

 #BASE 64 Decoded
 {PBKDF2_SHA256}AAAIAN0p+eG9q5J1i/UWR5+9CyxGbdmm5TDZokPe+5uzLHOwWkYGpmoRJFvtTuw6S77SdraoPnjcrcdsdljs3MMkZX7Jg8UIUblDcpQhQpoSTeBb/RPtNPKVYA04Dq6PFZlGl2mCq5hbT4iID8+WlI0sLuhm4K2kQSZq5hB+cZmOthH6iDsroXB16uHmNaJhOPEsa3JFmA6zzWzJMlsmKC1FntRctRm7Pzdia+tltAz5L4RG6qdhRmoIPmwb1hSKQW81bC9sR7C1EnlBGZNdNKBYYMTJeJWN1KIwkKRqdGtczKpKprSJ22eCzCkawQvyPlWtMQCZDHuZD7U2H1P3k0ztaU2j73BPqgv6PAE+X1hEIsDBLtvdzfGwFTTK/UjLwHAMyDwsDQP4Jy3eTGefkiEV7S+iZfVtTQ4Z/h/claka9XIs
```

---

### **Beginner Task:** 
##### Build a script that you can supply a single PBKDF2 hash and a single password to test for. The output should tell you if you had success or failure.

---

### **Intermediate Task:**  
##### Add onto the script to allow the input of a list of base64 DECODED hashes and a password list to test against and output to a file for easy review. (Use the already decoded example)

---

### **Expert Task:**
##### Add onto the script a functionality to parse through the ldapsearch and automatically base64 decode the data and add it to a list to test against a supplied password list (assuming you have the same format as the example)

---

### **Bonus Task:**
##### Add functionality to optionally thread out the testing. (Speed that password cracking up!)

---
COPYRIGHT Â© 2021 Jesse Leverett