#!/usr/bin/env python3
#-*- coding: UTF-8 -*-

'''
NAME: entropy.py
VERSION: 1.0
AUTHOR: Jesse Leverett (CyberThulhu)
STATUS: Complete
DESCRIPTION: This is a script which counts a character entropy in a single string.
TO-DO: N/A
USAGE: entropy.py STRING
CREDIT: Borrowed from http://blog.dkbza.org/2007/05/scanning-data-for-entropy-anomalies.html
COPYRIGHT Â© 2021 Jesse Leverett
'''
import math
import sys

BASE64_CHARS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="

def shannon_entropy(data):
    try:
        if not data:
            return 0
        entropy = 0
        for x in BASE64_CHARS:
            p_x = float(data.count(x))/len(data)
            if p_x > 0:
                entropy += - p_x*math.log(p_x, 2)
        return entropy

    except Exception as e:
        print("Error: " + str(e))


if __name__ == '__main__':

    if len(sys.argv) != 2:
        print("Exactly 1 argument is required.")
        print("Usage: entropy.py STRING")
        sys.exit()

    print("The entropy of a character in a string '" + sys.argv[1] + 
          "' is " + str(shannon_entropy(sys.argv[1])) + " bits")